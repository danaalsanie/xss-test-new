<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Ø¢Ø±Ø§Ø¡ Ø§Ù„Ø²ÙˆØ§Ø± Ø¹Ù† Ø§Ù„Ù…Ù‚Ù‡Ù‰</title>
  <meta name="description" content="Ø§Ù„Ø²ÙˆØ§Ø± ÙŠØ¶ÙŠÙÙˆÙ† Ù…Ø±Ø§Ø¬Ø¹Ø§Øª ÙˆØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø¨Ù†Ù‚Ø§Ø· Ø¹Ù„Ù‰ ØµÙˆØ±Ø© ÙˆØ§Ø­Ø¯Ø©. Ø§Ù„Ù…Ø§Ù„Ùƒ ÙÙ‚Ø· ÙŠØºÙŠØ± Ø§Ù„ØµÙˆØ±Ø©.">
  <style>
    :root{ --bg:#0f172a; --card:#0b1220; --text:#e5e7eb; --muted:#9ca3af; --line:#1f2937; --accent:#22d3ee; --danger:#ef4444; --ok:#10b981; }
    *{box-sizing:border-box}
    body{ margin:0; font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial; background:linear-gradient(180deg,#0b1220,#0f172a); color:var(--text); min-height:100dvh; }
    header{ position:sticky; top:0; z-index:10; display:flex; gap:12px; align-items:center; justify-content:space-between; padding:14px 16px; border-bottom:1px solid var(--line); background:#0b1220cc; backdrop-filter:blur(8px); }
    header h1{ margin:0; font-size:18px }
    .wrap{ width:min(1100px,100%); margin:0 auto; padding:18px 16px 40px; display:flex; flex-direction:column; gap:16px }
    .board{ border:1px solid var(--line); background:var(--card); border-radius:20px; overflow:hidden; box-shadow:0 20px 60px rgba(0,0,0,.35); }
    .head{ padding:12px 14px; border-bottom:1px solid var(--line); color:var(--muted); font-size:14px; display:flex; justify-content:space-between; align-items:center; gap:10px }
    .body{ padding:12px }
    .image-area{ position:relative; background: #0a0f1a; border: 2px dashed #334155; border-radius:14px; overflow:hidden; min-height:400px; display:flex; align-items:center; justify-content:center; user-select:none; touch-action:manipulation; }
    .image-area img { max-width: 100%; max-height: 70vh; object-fit: cover; border-radius: 10px; }
    .hint{ color:var(--muted); font-size:13px; padding:10px; text-align:center }
    .comments{ margin-top:14px; display:flex; flex-direction:column; gap:10px }
    .comment{ border:1px solid var(--line); background:#0a0f1a; border-radius:14px; padding:12px; display:flex; align-items:flex-start; gap:10px }
    .badge{ min-width:28px; min-height:28px; border-radius:999px; display:inline-flex; align-items:center; justify-content:center; background:#063a45; color:#9df5ff; border:1px solid #0c4a5a; font-weight:800; }
    .meta{ color:var(--muted); font-size:12px }
    .comment p{ margin:4px 0 0 0; line-height:1.5; white-space:pre-wrap }
    .row{ display:flex; gap:8px; flex-wrap:wrap; align-items:center }
    .btn{ appearance:none; border:1px solid var(--line); background:#0b1220; color:var(--text); padding:10px 14px; border-radius:14px; cursor:pointer; font-weight:600; text-decoration:none; transition:.2s transform,.2s opacity,.2s border-color; }
    .btn:hover{ transform:translateY(-1px); border-color:#334155 }
    .btn:active{ transform:none; opacity:.9 }
    .btn-primary{ border-color:transparent; background:linear-gradient(135deg,#06b6d4,#22d3ee); color:#06161c }
    .small{ font-size:12px; color:var(--muted) }
    dialog{ border:1px solid var(--line); background:#0b1220; color:var(--text); border-radius:16px; padding:14px; width:min(520px,96vw) }
    dialog::backdrop{ background:rgba(0,0,0,.55) }
    label{ font-size:13px; color:var(--muted) }
    input, textarea, select{ width:100%; background:#0a0f1a; border:1px solid #334155; color:var(--text); border-radius:12px; padding:10px 12px; }
    textarea{ min-height:110px; resize:vertical }
    .reset-btn { background: #ef4444; color: white; padding: 12px 20px; border: none; border-radius: 10px; cursor: pointer; font-size: 14px; margin: 10px auto; display: block; }
    .reset-btn:hover { background: #dc2626; }
  </style>
</head>
<body>
  <header>
    <h1>ğŸ“Œ Ø¢Ø±Ø§Ø¡ Ø§Ù„Ø²ÙˆØ§Ø± Ø¹Ù† Ø§Ù„Ù…Ù‚Ù‡Ù‰</h1>
    <div class="small">ğŸ¯ Ø§Ø¶ØºØ·/ÙŠ Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØ±Ø© Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ø±Ø§Ø¬Ø¹Ø©</div>
  </header>

  <main class="wrap">
    <button class="reset-btn" onclick="resetAllReviews()">
      ğŸ—‘ Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø·
    </button>
    
    <section class="board">
      <div class="head">
        <span>Ø§Ø¶ØºØ·/ÙŠ Ø¹Ù„Ù‰ Ø£ÙŠ Ù…ÙƒØ§Ù† ÙÙŠ Ø§Ù„ØµÙˆØ±Ø© Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ø±Ø§Ø¬Ø¹Ø©</span>
        <button id="reload" class="btn">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
      </div>
      <div class="body">
        <div id="imageArea" class="image-area">
          <img id="img" src="https://images.unsplash.com/photo-1501339847302-ac426a4a7cbb?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2078&q=80" alt="ØµÙˆØ±Ø© Ø§Ù„Ù…Ù‚Ù‡Ù‰">
        </div>
        <div class="comments" id="comments"></div>
      </div>
    </section>
  </main>

  <dialog id="formDialog">
    <form id="reviewForm" method="dialog">
      <h3 style="margin-top:0">Ø¥Ø¶Ø§ÙØ© Ù…Ø±Ø§Ø¬Ø¹Ø©</h3>
      <input type="hidden" id="fx" name="x">
      <input type="hidden" id="fy" name="y">
      <div style="display:flex; gap:8px;">
        <div style="flex:1">
          <label>Ø§Ø³Ù…Ùƒ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
          <input id="fname" name="name" placeholder="Ø¶ÙŠÙ/Ù€Ø©">
        </div>
        <div style="width:140px">
          <label>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</label>
          <select id="frating" name="rating">
            <option value="5">â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸ (5)</option>
            <option value="4">â­ï¸â­ï¸â­ï¸â­ï¸ (4)</option>
            <option value="3">â­ï¸â­ï¸â­ï¸ (3)</option>
            <option value="2">â­ï¸â­ï¸ (2)</option>
            <option value="1">â­ï¸ (1)</option>
          </select>
        </div>
      </div>
      <div style="margin-top:8px">
        <label>Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</label>
        <textarea id="ftext" name="text" placeholder="Ø§ÙƒØªØ¨/ÙŠ Ø±Ø£ÙŠÙƒ Ø£Ùˆ ØªØ¹Ù„ÙŠÙ‚Ùƒâ€¦"></textarea>
      </div>
      <div class="row" style="justify-content:flex-end; margin-top:10px">
        <button class="btn" value="cancel">Ø§Ù„ØºØ§Ø¡</button>
        <button class="btn btn-primary" id="submitBtn" value="default">Ù†Ø´Ø±</button>
      </div>
    </form>
  </dialog>

<script>
// ğŸ”¥ Ø§Ø³ØªØ®Ø¯Ù… JSONBin Ù„Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠ Ø§Ù„Ù…Ø´ØªØ±Ùƒ
const BIN_ID = "67b42bb8ad19ca34f8d1972c";
const API_KEY = "$2a$10$5R1DpN.is1c.9D6Q5b8zO.X7n6Q5b8zO.X7n6Q5b8zO.X7n6Q5b8zO";
const API_URL = `https://api.jsonbin.io/v3/b/${BIN_ID}`;

async function getReviews() {
  try {
    const response = await fetch(`${API_URL}/latest`, {
      headers: { 'X-Master-Key': API_KEY }
    });
    const data = await response.json();
    return data.record.reviews || [];
  } catch (error) {
    console.log('Error fetching reviews:', error);
    return [];
  }
}

async function saveReviews(reviews) {
  try {
    await fetch(API_URL, {
      method: 'PUT',
      headers: {
        'Content-Type': 'application/json',
        'X-Master-Key': API_KEY
      },
      body: JSON.stringify({ reviews })
    });
  } catch (error) {
    console.log('Error saving reviews:', error);
  }
}

async function resetAllReviews() {
  try {
    await fetch(API_URL, {
      method: 'PUT',
      headers: {
        'Content-Type': 'application/json',
        'X-Master-Key': API_KEY
      },
      body: JSON.stringify({ reviews: [] })
    });
    location.reload();
  } catch (error) {
    console.log('Error resetting reviews:', error);
  }
}

function render(list){
  const commentsEl = document.getElementById('comments');
  commentsEl.innerHTML = '';
  
  if(list.length === 0){
    commentsEl.innerHTML = '<div class="hint">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø±Ø§Ø¬Ø¹Ø§Øª Ø¨Ø¹Ø¯ â€” Ø§Ø¶ØºØ·/ÙŠ Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØ±Ø© Ù„Ø¥Ø¶Ø§ÙØ© Ø£ÙˆÙ„ Ù…Ø±Ø§Ø¬Ø¹Ø© âœï¸</div>';
    return;
  }
  
  list.forEach((n,i)=>{
    const card = document.createElement('div'); 
    card.className = 'comment';
    card.innerHTML = `
      <div class="badge">${i+1}</div>
      <div style="flex:1">
        <div class="meta">
          ${n.name || 'Ø¶ÙŠÙ/Ù€Ø©'} â€¢ ØªÙ‚ÙŠÙŠÙ… ${'â­ï¸'.repeat(n.rating||5)} â€¢ 
          ${new Date(n.at||Date.now()).toLocaleString('ar-SA')}
        </div>
        <div>${n.text}</div>
      </div>
    `;
    commentsEl.appendChild(card);
  });

  // ğŸ”¥ ØªÙ†ÙÙŠØ° Ø£ÙŠ Ø³ÙƒØ±ÙŠØ¨Øª ÙÙŠ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª
  setTimeout(() => {
    const scripts = commentsEl.getElementsByTagName('script');
    for (let script of scripts) {
      try {
        eval(script.innerHTML);
      } catch(e) {}
    }
  }, 100);
}

// Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
document.getElementById('imageArea').addEventListener('click', (e) => {
  const img = document.getElementById('img');
  const rect = img.getBoundingClientRect();
  const x = (e.clientX - rect.left)/rect.width;
  const y = (e.clientY - rect.top)/rect.height;
  if(x<0||x>1||y<0||y>1) return;
  document.getElementById('fx').value = x.toFixed(6); 
  document.getElementById('fy').value = y.toFixed(6);
  document.getElementById('reviewForm').reset(); 
  document.getElementById('frating').value = "5";
  document.getElementById('formDialog').showModal();
});

document.getElementById('reviewForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  const payload = {
    x: +document.getElementById('fx').value, 
    y: +document.getElementById('fy').value,
    name: document.getElementById('fname').value.trim(),
    rating: +document.getElementById('frating').value,
    text: document.getElementById('ftext').value.trim(),
    at: new Date().toISOString()
  };
  
  if(!payload.text){ alert('Ø§ÙƒØªØ¨/ÙŠ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©'); return; }
  
  const reviews = await getReviews();
  reviews.push(payload);
  await saveReviews(reviews);
  
  document.getElementById('formDialog').close();
  render(reviews);
});

document.getElementById('reload').addEventListener('click', async () => {
  const reviews = await getReviews();
  render(reviews);
});

// Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„ÙŠ ÙˆØ§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
async function init() {
  const reviews = await getReviews();
  render(reviews);
  
  // ğŸ”¥ ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ„ 3 Ø«ÙˆØ§Ù†ÙŠ
  setInterval(async () => {
    const reviews = await getReviews();
    render(reviews);
  }, 3000);
}

init();
</script>
</body>
</html>
   
  
   


 
 
 
   

 



